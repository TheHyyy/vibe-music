# QQ 音乐 Cookie 常见问题

## Q1: 需要会员吗？

**不需要！**

- ❌ **不需要 VIP 会员**
- ✅ 只需要**普通 QQ 账号**登录即可
- ✅ 可以播放所有**免费歌曲**（大部分歌曲都是免费的）
- ⚠️ 只有少数独家/VIP 歌曲需要会员才能播放

### 可以播放的歌曲示例（无需会员）：
- 晴天 - 周杰伦 ✅
- 七里香 - 周杰伦 ✅
- 大部分热门歌曲 ✅

### 需要会员的歌曲：
- 某些新歌独家版权
- 某些高音质版本
- 某些演唱会版本

**结论**：90% 的歌曲都可以用普通账号播放，不需要会员。

---

## Q2: Cookie 有效期多久？

**7-30 天**（通常 2-3 周）

### 有效期取决于：
1. **登录方式**：
   - QQ 号登录：7-14 天
   - 微信登录：14-30 天

2. **活跃度**：
   - 经常使用 QQ 音乐：有效期更长
   - 长期不用：可能 7 天就过期

3. **账号安全**：
   - 正常使用：稳定
   - 异常登录：可能被强制下线

### 会不会需要"每一两天配置一次"？

**不会！**

- ❌ 不是 1-2 天过期
- ✅ 通常是 2-3 周过期
- ✅ 最长可达 1 个月

### Cookie 过期会怎样？

1. 搜索功能：**仍然可用**（搜索不需要登录）
2. 播放 QQ 音乐：**会失败**，提示需要重新配置 Cookie
3. 网易云音乐：**不受影响**，继续正常工作

---

## Q3: 如何知道 Cookie 是否过期？

### 方法 1：看播放错误提示
```
错误：QQ音乐需要登录，请在 .env 中配置有效的 QQ_COOKIE
```

### 方法 2：运行测试脚本
```bash
cd server
node test-qq-cookie.mjs
```

输出：
```
✓ Cookie 设置成功
✓ 搜索成功
❌ 获取播放链接失败  # ← 说明 Cookie 过期了
```

### 方法 3：查看前端提示
前端播放 QQ 音乐歌曲时，如果 Cookie 过期会显示错误提示。

---

## Q4: 更新 Cookie 麻烦吗？

**不麻烦，只需 3 步（1 分钟）**：

```bash
# 1. 获取新 Cookie（30秒）
# 打开 y.qq.com → F12 → Application → Cookies → 复制 qm_keyst

# 2. 更新配置（10秒）
vim server/.env
# 修改 QQ_COOKIE=qm_keyst=新的值

# 3. 自动重启（20秒）
# tsx watch 会自动检测文件变化并重启服务
```

---

## Q5: 有没有自动更新 Cookie 的方法？

**没有自动方法，但有替代方案**：

### 方案 A：使用网易云为主
```bash
# 搜索时优先选择网易云的歌曲
# QQ 音乐只作为备用
# 这样即使 Cookie 过期也影响不大
```

### 方案 B：定期提醒
```bash
# 在日历上设置每 2 周提醒一次
# 检查 Cookie 是否有效
```

### 方案 C：使用长期 Cookie
```bash
# 微信登录的 Cookie 通常比 QQ 登录的有效期长
# 建议使用微信扫码登录 y.qq.com
```

---

## 实际使用建议

### 推荐配置（最省心）

1. **使用微信登录**（有效期更长）
   - 访问 y.qq.com
   - 使用微信扫码登录
   - 获取的 Cookie 有效期 2-4 周

2. **配置一次，用 2-3 周**
   - 更新频率：每 2-3 周一次
   - 耗时：1 分钟
   - 影响：只影响 QQ 音乐播放，网易云不受影响

3. **主要使用网易云**
   - 搜索：`source=all`（同时搜索两个平台）
   - 播放：优先选择 `netease:` 开头的歌曲
   - QQ 音乐：只播放网易云没有的独家歌曲

### 成本效益分析

| 方案 | 配置成本 | 维护成本 | 可用歌曲 |
|------|---------|---------|---------|
| 只用网易云 | 0 分钟 | 0 分钟 | 网易云曲库 |
| 配置 QQ Cookie | 1 分钟 | 2 分钟/月 | 网易云 + QQ 曲库 |
| QQ 会员 | 1 分钟 + ¥15/月 | 2 分钟/月 | 全部曲库 + VIP 歌曲 |

**结论**：
- 不需要会员
- 不需要频繁配置（2-3周一次）
- 1 分钟就能完成配置
- 主要用网易云，QQ 作为补充

---

## 测试你的 Cookie

```bash
cd /Users/houyu/Desktop/project/vibe-music/server
node test-qq-cookie.mjs
```

如果输出：
```
✓ 搜索成功
✓ 播放链接获取成功
```
说明 Cookie 有效，可以使用。

如果输出：
```
❌ 获取播放链接失败
```
说明 Cookie 已过期，需要重新获取。
